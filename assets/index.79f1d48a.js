import{r as e,R as t,u as a,S as r,a as n,c as s,b as l,d as c,e as i,f as o,g as u,h as m,i as d,B as p,P as g}from"./vendor.918e2fe8.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();function f(){return e.exports.createElement("svg",{t:1629139788953,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":2125,width:200,height:200},e.exports.createElement("path",{d:"M64 888.96V135.04a102.08 102.08 0 0 1 150.4-90.56l692.16 376.96a103.36 103.36 0 0 1 0 181.12L214.4 979.52A102.08 102.08 0 0 1 64 888.96zM128 135.04v753.92a37.76 37.76 0 0 0 55.68 34.24l692.16-376.96a39.04 39.04 0 0 0 0-68.48L183.68 100.8A37.76 37.76 0 0 0 128 135.04z",fill:"#ffffff","p-id":2126}))}function E(){return e.exports.createElement("svg",{t:1629139827152,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":2459,width:200,height:200},e.exports.createElement("path",{d:"M288 992H224a160 160 0 0 1-160-160V192a160 160 0 0 1 160-160h64a160 160 0 0 1 160 160v640a160 160 0 0 1-160 160zM224 96a96 96 0 0 0-96 96v640a96 96 0 0 0 96 96h64a96 96 0 0 0 96-96V192a96 96 0 0 0-96-96zM800 992h-64a160 160 0 0 1-160-160V192a160 160 0 0 1 160-160h64a160 160 0 0 1 160 160v640a160 160 0 0 1-160 160zM736 96a96 96 0 0 0-96 96v640a96 96 0 0 0 96 96h64a96 96 0 0 0 96-96V192a96 96 0 0 0-96-96z",fill:"#ffffff","p-id":2460}))}function k(){return e.exports.createElement("svg",{t:1629139803414,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":2292,width:200,height:200},e.exports.createElement("path",{d:"M32 820.48V203.52a96 96 0 0 1 141.76-84.48l569.6 308.48a96 96 0 0 1 0 168.96l-569.6 308.48A96 96 0 0 1 32 820.48zM96 203.52v616.96a32 32 0 0 0 47.36 28.16l569.6-308.48a32 32 0 0 0 0-56.32L143.36 175.36A32 32 0 0 0 96 203.52zM960 928a32 32 0 0 1-32-32V128a32 32 0 0 1 64 0v768a32 32 0 0 1-32 32z",fill:"#ffffff","p-id":2293}))}function v(){return e.exports.createElement("svg",{t:1629139775387,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":1958,width:200,height:200},e.exports.createElement("path",{d:"M850.24 904.96l-569.6-308.48a96 96 0 0 1 0-168.96l569.6-308.48A96 96 0 0 1 992 203.52v616.96a96 96 0 0 1-141.76 84.48z m30.4-729.6l-569.6 308.48a32 32 0 0 0 0 56.32l569.6 308.48a32 32 0 0 0 47.36-28.16V203.52a32 32 0 0 0-47.36-28.16zM64 928a32 32 0 0 1-32-32V128a32 32 0 0 1 64 0v768a32 32 0 0 1-32 32z",fill:"#ffffff","p-id":1959}))}const y=({isPlaying:e,onPlayPauseClick:a,onPrevClick:r,onNextClick:n})=>t.createElement("div",{className:"audio-controls"},t.createElement("button",{type:"button",className:"prev","aria-label":"Previous",onClick:r},t.createElement(v,null)),e?t.createElement("button",{type:"button",className:"pause",onClick:()=>a(!1),"aria-label":"Pause"},t.createElement(E,null)):t.createElement("button",{type:"button",className:"play",onClick:()=>a(!0),"aria-label":"Play"},t.createElement(f,null)),t.createElement("button",{type:"button",className:"next","aria-label":"Next",onClick:n},t.createElement(k,null)));const h=({trackIndex:e,isPlaying:a})=>t.createElement("div",{className:"color-backdrop "+(a?"playing":"idle")}),x=()=>{const r=a((e=>e.musicList.value)),[n,s]=e.exports.useState(0),[l,c]=e.exports.useState(0),[i,o]=e.exports.useState(!1),{title:u,artist:m,audioSrc:d,image:p}=r[n],g=e.exports.useRef(new Audio(d)),f=e.exports.useRef(0),E=e.exports.useRef(!1),{duration:k}=g.current,v=k?l/k*100+"%":"0%",x=`\n    -webkit-gradient(linear, 0% 0%, 100% 0%, color-stop(${v}, #fff), color-stop(${v}, #777))\n    `,w=()=>{n<r.length-1?s(n+1):s(0)},b=()=>{clearInterval(f.current),f.current=setInterval((()=>{g.current.ended?w():c(g.current.currentTime)}),1e3)},N=()=>{i||o(!0),b()};return e.exports.useEffect((()=>{i?(g.current.play(),b()):(g.current.pause(),clearInterval(f.current))}),[i]),e.exports.useEffect((()=>{g.current.pause(),g.current=new Audio(d),c(g.current.currentTime),E.current?(g.current.play(),o(!0),b()):E.current=!0}),[n]),e.exports.useEffect((()=>()=>{g.current.pause(),clearInterval(f.current)}),[]),t.createElement("div",{className:"audio-player"},t.createElement("div",{className:"track-info"},t.createElement("img",{className:"artwork",src:p,alt:`track artwork for ${u} by ${m}`}),t.createElement("h2",{className:"title"},u),t.createElement("h3",{className:"artist"},m)),t.createElement(y,{isPlaying:i,onPrevClick:()=>{s(n-1<0?r.length-1:n-1)},onNextClick:w,onPlayPauseClick:o}),t.createElement("input",{type:"range",value:l,step:"1",min:"0",max:k||`${k}`,className:"progress",onChange:e=>{return t=e.target.value,clearInterval(f.current),g.current.currentTime=t,void c(g.current.currentTime);var t},onMouseUp:N,onKeyUp:N,style:{background:x}}),t.createElement(h,{trackIndex:n,isPlaying:i}))},w=()=>t.createElement("div",null,t.createElement(x,null)),b=()=>t.createElement("div",null,t.createElement(w,null));class N{static redirectToOAuth(){const e={client_id:"12f43a9e50fc400581ee8d65184b0414",redirect_uri:"http://localhost:3000/callback",scope:["streaming","user-read-email","user-read-private","playlist-read-private"].join(" "),response_type:"token",show_dialog:"true"},t=new URL("https://accounts.spotify.com/authorize");Object.entries(e).forEach((([e,a])=>{t.searchParams.append(e,a)})),location.replace(t.toString())}static saveToken(){const e=window.location.hash.substring(1).split("&").reduce(((e,t)=>{let a=t.split("=");return e[a[0]]=decodeURIComponent(a[1]),e}),{});return console.log(e),[e.access_token,e.expires_in]}_getToken(){}_getPlayer(){}static async getMusicListId(e){const t=new r;return t.setAccessToken(e),t.getUserPlaylists()}static getMusicList(e,t){const a=new r;return a.setAccessToken(e),a.getPlaylist(t)}}const L=()=>{const r=a((e=>e.musicList.loading));let s=n();return e.exports.useEffect((()=>{console.log(s)}),[s]),t.createElement("div",{className:"login"},t.createElement("img",{src:"Spotify_Logo_RGB_White.png",alt:"Spotify logo",className:"logo"}),r?t.createElement("button",{className:"login-btn",disabled:!0},"Loading..."):t.createElement("button",{className:"login-btn",onClick:()=>{N.redirectToOAuth()}},"LOGIN WITH SPOTIFY"))},M=s({name:"token",initialState:{value:"",expired:!0},reducers:{setToken:(e,t)=>{e.value=t.payload},setTokenisExpired:e=>{e.expired=!0},setTokenisNotExpired:e=>{e.expired=!1}}}),{setToken:_,setTokenisExpired:P,setTokenisNotExpired:T}=M.actions;var S=M.reducer;const C=l("music/getMyFirstMusicListID",(async e=>(await N.getMusicListId(e)).items[0].id)),I=l("music/getMyFirstMusicList",(async e=>{const{access_token:t,playlist_id:a}=e,r=await N.getMusicList(t,a);console.log("data",r);return r.tracks.items.map((e=>({id:e.track.uri,title:e.track.name,audioSrc:e.track.preview_url,artist:e.track.artists[0].name,length:e.track.duration_ms,albumName:e.track.album.name,image:e.track.album.images[0].url})))})),z=l("music/getMyMusicListReady",(async e=>{const{access_token:t,playlist_id:a}=e,r=await N.getMusicList(t,a);console.log("data",r);return r.tracks.items.map((e=>({id:e.track.uri,title:e.track.name,audioSrc:e.track.preview_url,artist:e.track.artists[0].name,length:e.track.duration_ms,albumName:e.track.album.name,image:e.track.album.images[0].url})))})),A=s({name:"musicList",initialState:{value:[],id:"",ready:!1,loading:!1},reducers:{setLoading:e=>{e.loading=!0}},extraReducers:e=>{e.addCase(C.fulfilled,((e,t)=>{e.id=t.payload})),e.addCase(I.fulfilled,((e,t)=>{e.value=t.payload})),e.addCase(z.fulfilled,(e=>{e.ready=!0}))}}),{setLoading:R}=A.actions;function V(){const r=a((e=>e.token.value)),n=a((e=>e.musicList.id)),s=a((e=>e.musicList.value)),l=c();return e.exports.useEffect((()=>{l(C(r))}),[r]),e.exports.useEffect((()=>{l(I({access_token:r,playlist_id:n}))}),[n]),t.createElement("div",null,t.createElement(i,null,t.createElement(o,{path:"/login"},t.createElement(L,null)),t.createElement(o,{path:"/callback",render:()=>((()=>{const[e,t]=N.saveToken();l(_(e)),l(T()),l(R())})(),t.createElement(u,{to:"/"}))}),t.createElement(o,{path:"/"},0!=s.length?t.createElement(b,null):t.createElement(L,null))))}const B=m({reducer:{musicList:A.reducer,token:S}});console.log(B.getState()),B.subscribe((()=>console.log(B.getState()))),d.render(t.createElement(t.StrictMode,null,t.createElement(p,null,t.createElement(g,{store:B},t.createElement(V,null)))),document.getElementById("root"));
